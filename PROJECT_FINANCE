SELECT I.CODE ID, I.NAME PROJECT_NAME, M.FULL_NAME PROJECT_MANAGER,
       TO_CHAR(P.PRSTART,'MonthYYYY') START_DATE, TO_CHAR(P.PRFINISH,'MonthYYYY') FINISH_DATE,
       O.DEPARTMENT_TYPE DEPARTMENT_TYPE, O.BUSINESS_UNIT_NAME BUSINESS_UNIT_NAME, 
       PT.NAME PROJECT_TYPE,
       C.Y2012,C.Y2013,C.Y2014
FROM INV_INVESTMENTS I,
     SRM_RESOURCES M,
     PRJ_PROJECTS P,
     ODF_CA_PROJECT OC,
     (SELECT LOOKUP_CODE ID,NAME FROM WARM01.CMN_LOOKUPS_V WHERE LOOKUP_TYPE='OBJ_IDEA_PROJECT_TYPE' AND LANGUAGE_CODE='en') PT,
     (SELECT INVESTMENTS_OBS_UNITS.INVESTMENT_ID,DEPARTMENT_TYPES.NAME DEPARTMENT_TYPE,CASE WHEN BUSINESS_UNITS.UNIT_ID IS NULL THEN '6101' ELSE BUSINESS_UNITS.UNIQUE_NAME END BUSINESS_UNIT_ID,CASE WHEN BUSINESS_UNITS.UNIT_ID IS NULL THEN 'Corporate Information' ELSE BUSINESS_UNITS.NAME  END BUSINESS_UNIT_NAME FROM (SELECT INV_OBS_UNITS.INVESTMENT_ID, INV_OBS_UNITS.OBS_UNIT FROM WARM01.INV_OBS_ONLY_V INV_OBS_UNITS, WARM01.PRJ_OBS_UNITS OBS_UNITS, WARM01.PRJ_OBS_TYPES OBS_TYPES WHERE INV_OBS_UNITS.OBS_UNIT = OBS_UNITS.ID AND OBS_UNITS.TYPE_ID = OBS_TYPES.ID AND OBS_TYPES.ID = 5000001) INVESTMENTS_OBS_UNITS, 
     (SELECT UNIT_ID, UNIQUE_NAME, NAME FROM WARM01.OBS_UNITS_V WHERE DEPTH = 1 AND UNIT_MODE = 'OBS_UNIT_AND_ANCESTORS') DEPARTMENT_TYPES, 
     (SELECT UNIT_ID, UNIQUE_NAME, NAME FROM WARM01.OBS_UNITS_V WHERE DEPTH = 3 AND UNIT_MODE = 'OBS_UNIT_AND_ANCESTORS') BUSINESS_UNITS WHERE INVESTMENTS_OBS_UNITS.OBS_UNIT = DEPARTMENT_TYPES.UNIT_ID(+) AND INVESTMENTS_OBS_UNITS.OBS_UNIT = BUSINESS_UNITS.UNIT_ID(+)) O,
     (
        SELECT CODE,SUM(Y2012) Y2012,SUM(Y2013) Y2013,SUM(Y2014) Y2014 FROM (
        SELECT INVESTMENTCODE CODE,
               CASE WHEN SUBSTR(START_DATE,0,4) = '2012' THEN SUM(COST) ELSE 0 END Y2012,
               CASE WHEN SUBSTR(START_DATE,0,4) = '2013' THEN SUM(COST) ELSE 0 END Y2013,
               CASE WHEN SUBSTR(START_DATE,0,4) = '2014' THEN SUM(COST) ELSE 0 END Y2014
        FROM CID_TEMP_BASELINE_BUDGETS
        GROUP BY INVESTMENTCODE,START_DATE)
        GROUP BY CODE
     ) C
WHERE I.ID = P.PRID(+)
      AND I.ID = OC.ID(+)
      AND I.ID = O.INVESTMENT_ID(+)
      AND OC.OBJ_REQUEST_TYPE = PT.ID(+)
      AND I.CODE = C.CODE
      AND I.MANAGER_ID = M.USER_ID(+)_